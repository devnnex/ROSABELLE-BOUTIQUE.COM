<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <title>üå∏Inventario Rosabelle | Santana Groupüå∏</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />

  <!-- CSS -->
  <link rel="stylesheet" href="style.css" />

  <!-- Font -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">

  
  <!-- üß© Favicon cl√°sico -->
  <link rel="icon" type="image/png" href="./images/favicon.png">

  <!-- üì± √çcono de app (iOS / Android) -->
  <link rel="apple-touch-icon" href="./images/favicon.png">

  <!-- üß≠ Configuraci√≥n PWA -->
  <meta name="theme-color" content="#000000">
  <meta name="mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="apple-mobile-web-app-title" content="Rosabelle App">

  <!-- üìú Manifest -->
  <link rel="manifest" href="./manifest.json">
</head>
<body>

  
<!-- =========================
  NAVBAR
========================= -->
<header class="navbar">
  <div class="nav-left">
    <img src="images/logo.png" alt="Santana Group" class="logo">
  </div>

  <nav class="nav-menu">
    <a class="active" data-view="inventario">Inventario</a>
    <a data-view="ventas">Ventas</a>
    <!-- <a data-view="analisis">An√°lisis</a> -->
    <!-- <a data-view="agotados">Agotados</a> -->
    <a data-view="clientes">Clientes</a>
  </nav>
</header>

<!-- =========================
  CONTENIDO
========================= -->
<main class="container">

  <!-- =====================
       VISTA INVENTARIO
  ====================== -->
  <section id="view-inventario" class="view active">

    <!-- TITULO -->
    <div class="page-header">
      <h1>Inventario</h1>

      <div class="page-actions">
        <button id="btnNuevo" class="primary">+ Agregar Producto</button>
        <div class="sell-cart-wrapper"><button class="primary venderSeleccionados" id="btnSellCart" onclick="venderSeleccionados()">Vender seleccionados</button><span id="sellCartBadge" class="sell-cart-badge hidden">0</span></div>
        <button id="btnDeleteInventorySelected" class="outline" disabled>Eliminar seleccionados (0)</button>

        <button class="outline" onclick="exportInventoryTablePDF()">Exportar PDF</button>
        <button class="outline" onclick="exportInventoryTableExcel()">Exportar Excel</button>
      </div>
    </div>

    <!-- BUSCADOR -->
    <input
      type="text"
      class="search"
      placeholder="Buscar productos..."
    />

    <!-- TOTAL -->
    <div class="total-box">
      Total Venta: $ <span id="sellTotal">0</span>
    </div>

    <select id="inventoryFilter" class="inventory-filter">
  <option value="all">Todos</option>
  <option value="new">Nuevos (24h)</option>
  <option value="out">Agotados</option>
</select>

    <!-- INVENTARIO -->
    
    <section class="glass">
      <table id="inventoryTable">
        <thead>
          <tr>
            <th><input type="checkbox" id="selectAllInventory"></th>
            <th>Producto</th>
            <th>Marca</th>
            <th>Precio Venta</th>
            <th style="display:none;">Costo</th>
            <th style="display:none;">categoria</th>
            <th style="display:none;">subcategoria</th>
            <th>Stock</th>
            <th>Vendidos</th>
            <th>Acciones</th>
          </tr>
        </thead>

        <tbody id="tbody">
          <!-- JS renderiza aqu√≠ -->
        </tbody>
      </table>
    </section>

  </section>

  <!-- =====================
       VISTA VENTAS
  ====================== -->
  <section id="view-ventas" class="view">

    <div class="page-header">
      <h1 class="ventass">Ventas</h1>

      <div id="ventasKPI" class="ventas-kpi">
  <!-- Aqu√≠ JS inyectar√° los KPIs de ventas del dia en base al metodo de pago din√°micamente -->
     </div>

    </div>
  

  <!-- =========================
    FILTROS VENTAS
========================= -->
  <div class="sales-filters">
  <select id="filterFecha" style="display: none;">
    <option value="">Todas las fechas</option>
    <option value="hoy">Hoy</option>
    <option value="ayer">Ayer</option>
    <option value="ultimos7">√öltimos 7 d√≠as</option>
    <option value="ultimos30">√öltimos 30 d√≠as</option>
  </select>
  <select id="filterProducto">
    <option value="">Todos los productos</option>
  </select>
  <select id="filterMarca">
    <option value="">Todas las marcas</option>
  </select>
  <select id="filterMetodo1">
    <option value="">Todos los m√©todos 1</option>
  </select>
  <select id="filterMetodo2">
    <option value="">Todos los m√©todos 2</option>
  </select>
  <button
  id="btnDownloadSalesPDF"
  class="outline"
  onclick="exportSalesTablePDF()"
>
  üìÑ Descargar PDF
</button>

<button
  id="btnDownloadSalesExcel"
  class="outline"
  onclick="exportSalesTableExcel()"
>
  üìä Descargar Excel
</button>

  </div>

    <section class="glass fade">
      <table id="salesTable">
        <thead>
          <tr>
            <th>Producto</th>
            <th>Marca</th>
            <th>Cantidad</th>
            <th>Total</th>
            <th>Descuento</th>
            <th>M√©todo Pago 1</th>
            <th>M√©todo Pago 2</th>
            <th>Fecha</th>
            <th>Hora</th>
            <th>Acciones</th>
          </tr>
        </thead>

        <tbody id="salesTbody">
          <!-- JS -->
        </tbody>
      </table>
    </section>
  </section>


      <!-- =====================
     VISTA ANALISIS
====================== -->
<section id="view-analisis" class="view">
  <!-- =========================
  REPORTES
========================= -->
<!-- <div class="analysis-card report-card">

  <h3>üìä Reportes</h3>

  <div class="report-controls">

    <select id="reportSheet">
      <option value="inventario">Inventario</option>
      <option value="ventas">Ventas</option>
    </select>

    <select id="reportMonth">
      <option value="">Todos los meses</option>
    </select>  

    <select id="reportYear">
      <option value="">Todos los a√±os</option>
    </select>

    <button class="btn-report excel" onclick="downloadReport('excel')">
      üì• Excel
    </button>

      <button class="btn-report pdf" onclick="downloadReport('pdf')">
      üìÑ PDF
    </button>

  </div>

</div> -->


  <!-- HEADER -->
  <div class="page-header">
    <h1>An√°lisis</h1>

    <!-- Selector Mes / A√±o -->
    <div class="analysis-filters sales-filters">
  <select id="analysisMonth"></select>
  <select id="analysisYear"></select>
</div>
  </div>

  <!-- =========================
   CARDS KPIS
========================= -->
  <div class="analysis-grid">

    <div class="analysis-card primary">
      <h4>Ventas del Mes</h4>
      <span id="kpiVentas">$0</span>
    </div>

    <div class="analysis-card success">
      <h4>Ganancia/Mes con Descuentos</h4>
      <span id="kpiGanancia">$0</span>
    </div>

    <div class="analysis-card warning">
      <h4>Total Descuentos</h4>
      <span id="kpiDescuentos">$0</span>
    </div>

    <div class="analysis-card info">
  <div class="kpi-header">
    <h4>Sugerido a Invertir</h4>

    <div class="kpi-actions">
      <button id="resetInvestmentBtn" title="Confirmar inversi√≥n">
        ‚ôªÔ∏è
      </button>
      <button id="revertInvestmentBtn" title="Revertir">
        ‚Ü©Ô∏è
      </button>
    </div>
  </div>

  <span id="kpiSinDescuento">$0</span>
</div>


  </div>

  <!-- GRID PRINCIPAL -->
  <div class="analysis-layout">

    <!-- =========================
      GASTOS 
     ========================= -->
    <div class="analysis-card gastos-card">
      <h3>Gastos del Mes</h3>

      <form id="expenseForm" class="expense-form">
        <input type="text" id="gastoNombre" placeholder="Nombre del gasto" required>
        <input type="number" id="gastoValor" placeholder="Valor" required>
        <button id="btnAgregarGasto">Agregar</button>
      </form>

      <ul id="expenseList" class="expense-list"></ul>

      <div class="expense-total">
        Ganancia Neta: <b id="ganancia_neta">$0</b>
      </div>
      <div class="expense-total">
        Pagado en gastos: <b id="totalpagado">$0</b>
      </div>
    </div>
<!-- =========================
  GR√ÅFICOS
========================= -->
    <div class="analysis-card chart-card">
      <h3>Ventas por Mes</h3>
      <canvas id="salesByMonthChart"></canvas>
    </div>

    <div class="analysis-card chart-card">
      <h3>Top 10 Productos Vendidos</h3>
      <canvas id="topProductsChart"></canvas>
    </div>
  </div>
  
  <!-- =========================
  AN√ÅLISIS POR MARCA
  ========================= -->
    <div class="analysis-card brand-analysis-card">
  <h3>An√°lisis por Marca</h3>
  <p style="font-size: 14px;"> la inversion disminuye cada que vendes una prenda, asi vas recuperando tu inversion hasta llegar a $0</p>
  <table id="brandAnalysisTable">
    <thead>
      <tr>
        <th>Marca</th>
        <th>Productos</th>
        <th>Vendidos</th>
        <th>Inversi√≥n</th>
        <th>Ventas</th>
        <th>Ganancia</th>
      </tr>
    </thead>
    <tbody>
      <!-- JS llenar√° aqu√≠ -->
    </tbody>
  </table>
</div>

</section>


 <!-- =========================
  VISTA CLIENTES
  ========================= -->
<section id="view-clientes" class="view">
  <div class="page-header">
    <h1>Clientes</h1>

   


  <!-- ACCIONES Y BUSCADOR -->

    <div class="page-actions">
      <button id="btnAddClient" class="primary">+ Agregar Cliente</button>
      <button id="btnDeleteSelected" class="outline">Eliminar seleccionados</button>
      <input type="text" id="searchClient" placeholder="üîç Buscar cliente..." />
    </div>
  </div>

   <!-- KPIs CLIENTES -->
<div class="analysis-grid" id="clientsKPIs">
  <div class="analysis-card primary">
    <h4>Total de Clientes</h4>
    <span id="totalClientes">0</span>
  </div>


<div class="analysis-card success">
  <h4>Pr√≥ximo cumplea√±os</h4>
  <div id="nextBirthday" class="birthday-kpi">
    <!-- <button id="prevBirthday" class="kpi-btn">‚¨ÖÔ∏è</button> -->
    <span id="nextBirthdayInfo" class="small-text">‚Äî</span>
    <!-- <button id="nextBirthday" class="kpi-btn">‚û°Ô∏è</button> -->
    <button id="emailNextBirthday" class="kpi-btn email-btn">üìß Enviar correo</button>
  </div>
</div>


  <!-- <div class="analysis-card warning">
    <h4>Cumplea√±os este mes</h4>
    <span id="birthdaysThisMonth">0</span>
  </div> -->
</div>

<div class="table-wrapper">
  <table id="clientsTable">
    <thead>
      <tr>
        <th><input type="checkbox" id="selectAllClients"></th>
        <th>Nombre</th>
        <th>Tel√©fono</th>
        <th>Correo</th>
        <th>Cumplea√±os</th>
        <th>Registrado</th>
        <th>Acciones</th>
      </tr>
    </thead>
    <tbody></tbody>
  </table>
</div>

</section>


</main>

<!-- =========================
  MODAL NUEVO PRODUCTO
========================= -->
<div class="modal hidden" id="modal">
  <form id="form" class="modal-card">
    <h2>Nuevo Producto</h2>

    <div class="field">
      <input name="nombre" placeholder=" " required />
      <label>Nombre *</label>
    </div>

    <div class="field">
      <input name="marca" placeholder=" " required />
      <label>Marca *</label>
    </div>

    <div class="field">
      <input name="categoria" placeholder=" " />
      <label>Categor√≠a</label>
    </div>

    <div class="field">
      <input name="subcategoria" placeholder=" " />
      <label>Subcategor√≠a</label>
    </div>

    <div class="field">
      <input type="number" name="costo" placeholder=" " required />
      <label>Costo por unidad *</label>
    </div>

    <div class="field">
      <input type="number" name="margen" placeholder=" " value="100" required />
      <label>% Margen *</label>
    </div>

    <div class="field">
      <input type="number" name="cantidad" placeholder=" " value="1" required />
      <label>Cantidad *</label>
    </div>

    <div class="modal-actions">
      <button type="button" class="ghost" id="btnCancelar">Cancelar</button>
      <button type="submit">Guardar</button>
    </div>
  </form>
</div>

<!-- =========================
  MODAL EDITAR PRODUCTO (B√ÅSICO)
========================= -->
<div class="modal hidden" id="editModal">
  <form id="editForm" class="modal-card">
    <h2>Editar producto</h2>

    <div class="field">
      <input name="nombre" placeholder=" " required />
      <label>Nombre *</label>
    </div>

    <div class="field">
      <input name="marca" placeholder=" " required />
      <label>Marca *</label>
    </div>

    <div class="field">
      <input type="number" name="cantidad" placeholder=" " required />
      <label>Cantidad *</label>
    </div>

    <div class="modal-actions">
      <button type="button" class="ghost" id="btnEditCancelar">Cancelar</button>
      <button type="submit">Guardar cambios</button>
    </div>
  </form>
</div>



<!-- =========================
  MODAL PRODUCTOS DE MARCA
========================= -->
<div class="modal hidden" id="brandModal">
  <div class="modal-card">
    <h2 id="brandModalTitle">Productos de Marca</h2>
    <p style="font-size: 12px;">La columna ‚ÄòTotal Inversi√≥n‚Äô muestra cu√°nto de tu inversi√≥n inicial queda por recuperar. Cada venta reduce el valor invertido por prenda, lo que te cost√≥. Hasta llegar a cero. Lo dem√°s es ganancia</p>
    <table id="brandProductsTable">
      <thead>
        <tr>
          <th>Producto</th>
          <th>Stock</th>
          <th>Costo Unit.</th>
          <th>Total Inversi√≥n</th>
        </tr>
      </thead>
      <tbody>
        <!-- JS inyectar√° los productos aqu√≠ -->
      </tbody>
    </table>
    <div class="modal-actions">
      <button type="button" id="brandModalClose" class="ghost">Cerrar</button>
    </div>
  </div>
</div>


<!-- =========================
  MODAL NUEVO CLIENTE
========================= -->
<div class="modal hidden" id="clientModal">
  <form id="clientForm" class="modal-card two-columns">
    <h2 id="clientModalTitle">Nuevo Cliente</h2>

    <div class="field">
      <input id="clientName" name="nombre" placeholder=" " required />
      <label>Nombre *</label>
    </div>

    <div class="field">
      <input id="clientPhone" name="telefono" placeholder=" " />
      <label>Tel√©fono</label>
    </div>

    <div class="field">
      <input type="email" id="clientEmail" name="correo" placeholder=" " />
      <label>Correo</label>
    </div>

    <div class="field">
      <input type="date" id="clientBirthday" name="fechacumple" placeholder=" " />
      <label>Fecha de Cumplea√±os</label>
    </div>

    <input type="hidden" id="clientId" /> <!-- campo oculto para editar -->

    <div class="modal-actions">
      <button type="button" class="ghost" id="clientModalClose">Cancelar</button>
      <button type="submit">Guardar</button>
    </div>
  </form>
</div>


<!-- =========================
  MODAL PRENDAS RECIENTES
========================= -->
<div class="modal hidden" id="recentProductsModal">
  <div class="modal-card">

    <!-- HEADER ARRIBA DE LA TABLA -->
    <div class="modal-header">
      <h2>üìù Prendas Agregadas recientes</h2>
      <span class="modal-subtitle">√öltimas 24 horas</span>
    </div>
    <br>
    <div class="table-wrapper">
    <table>
      <thead>
        <tr>
          <th>Producto</th>
          <th>Marca</th>
          <th>Stock</th>
          <th>Vendidos</th>
          <th>Fecha</th>
        </tr>
      </thead>
      <tbody id="recentProductsTbody">
        <!-- JS -->
      </tbody>
    </table>
    </div>
 <br>
    <div class="modal-actions">
      <button type="button" class="ghost" onclick="closeRecentProductsModal()">
        Cerrar
      </button>
    </div>

  </div>
</div>


<!-- =========================
  MODAL MENSAJES / SITUACIONES
========================= -->
<div class="modal hidden" id="messagesModal">
  <form class="modal-card" onsubmit="guardarSituacion(event)">
    
    <h2>üí¨ Mensajes del d√≠a</h2>

    <!-- FORMULARIO -->
<div id="mensajeFormView">
  <!-- TODO lo que ya tienes -->
</div>

<!-- HISTORIAL -->
<div id="mensajeTableView" class="hidden">

  <h2>üìã Historial de situaciones</h2>

  <div class="table-wrapper">
    <table class="situaciones-table">
      <thead>
        <tr>
          <th>Mensaje</th>
          <th>Fecha</th>
          <th>Hora</th>
          <th></th>
        </tr>
      </thead>
      <tbody id="situacionesTableBody"></tbody>
    </table>
  </div>

  <div class="modal-actions">
    <button class="ghost" onclick="volverFormularioSituacion()">
      Volver
    </button>
  </div>

</div>


    <button
    type="button"
    class="history-btn"
    title="Ver historial"
    onclick="toggleHistorial()"
  >
    üïí
  </button>

    <!-- MENSAJE -->
    <div class="field-group">
      <label for="mensajeTexto">Situaci√≥n / Nota</label>
      <textarea
        id="mensajeTexto"
        rows="5"
        placeholder="Describe la situaci√≥n del d√≠a..."
        required
      ></textarea>
    </div>

    <!-- SELECTS -->
    <div class="field-row">

      <div class="field-group">
        <label for="mensajeTipo">Tipo de mensaje</label>
        <select id="mensajeTipo">
          <option value="Nota">Nota</option>
          <option value="Venta">Venta</option>
          <option value="Problema">Problema</option>
          <option value="Cliente">Cliente</option>
          <option value="Decisi√≥n">Decisi√≥n</option>
        </select>
      </div>

      <div class="field-group">
        <label for="mensajeImportancia">Importancia</label>
        <select id="mensajeImportancia">
          <option value="1">Baja</option>
          <option value="2">Media</option>
          <option value="3">Alta</option>
        </select>
      </div>

    </div>

    <!-- ACCIONES -->
    <div class="modal-actions">
      <button type="button" class="ghost" onclick="closeMessagesModal()">
        Cancelar
      </button>
      <button type="submit">
        Guardar
      </button>
    </div>

  </form>
</div>



<!-- =========================
  MODAL HISTORIAL DE SITUACIONES
========================= -->
<div class="modal hidden" id="situacionesModal">

  <div class="modal-card situaciones-card">

    <!-- HEADER -->
    <div class="situaciones-header">
      <h2>üìã Historial de situaciones</h2>
      <button class="ghost" onclick="closeSituacionesModal()">Cerrar</button>
    </div>

    <!-- TABLA -->
    <div class="situaciones-table-wrapper">
      <table class="situaciones-table">
        <thead>
          <tr>
            <th>Mensaje</th>
            <th>Tipo</th>
            <th>Importancia</th>
            <th>Fecha</th>
            <th></th>
          </tr>
        </thead>
        <tbody id="historialBody">
          <!-- JS renderiza -->
        </tbody>
      </table>
    </div>

  </div>
</div>








<!-- ===============================
     BOT√ìN FLOTANTE VENDER (OCULTO POR DEFECTO)
=============================== -->
<button
  id="btnSellFloating"
  class="sell-floating"
  onclick="venderSeleccionados()"
  aria-label="Vender seleccionados"
>
  üõí
  <span id="sellFloatingBadge" class="sell-cart-badge hidden">0</span>
</button>

 
<!-- ===============================
     BOT√ìN FLOTANTE NUEVAS PRENDAS (24H O 48H CAMBIA EL VALOR DEL PARAMETRO)
=============================== -->
<button
  class="sell-floating sell-floating-notes"
  onclick="openRecentProductsModal(24)"
  aria-label="Prendas recientes"
>
  üìù
  
</button>

<!-- ===============================
     BOT√ìN FLOTANTE SITUACIONES DEL D√çA
=============================== -->
<button
  class="sell-floating sell-floating-messages"
  onclick="openMessagesModal()"
  aria-label="Situaciones del d√≠a"
>
  üí≠
</button>

<!-- ===============================
    BOTON FLOATING HISTORIAL DE SITUACIONES
=============================== -->

<!-- <button
  class="sell-floating sell-floating-situations"
  onclick="openSituacionesModal()"
  aria-label="Historial de situaciones"
>
  üìö
</button> -->






<!-- =========================
  FOOTER
========================= -->
<footer class="footer">
  ¬© 2025 Santana Group
</footer>


<!-- JS CDN PDF AND EXCEL-->
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/xlsx/dist/xlsx.full.min.js"></script>
<!-- JS CDN FOR EMAIL JS-->
<script src="https://cdn.jsdelivr.net/npm/emailjs-com@3/dist/email.min.js"></script>
<script>
    emailjs.init("WG36JQzyb-sxnapxf"); // üëà Reemplaza con tu Public Key de EmailJS
</script>
<!-- ‚úÖ SweetAlert2 -->
<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<!-- ‚úÖ LOCAL FILES  -->
<script src="analisis.js" defer></script>
<script src="app.js" defer></script>

<!-- GLOBAL LOADER -->
<div id="globalLoader" class="loader hidden">
  <div class="loader-card">
    <div class="spinner"></div>
    <span>Cargando informaci√≥n...</span>
  </div>
</div>

</body>
</html>



